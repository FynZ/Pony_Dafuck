<h1 class="content-title">Liste des utilisateurs</h1>
<div class="row">
     <div class="col-xs-12">
          <div class="box box-primary">
               <div class="box-body table-responsive padding">
                    <table id='users-table' class='table'>
                         <thead>
                              <tr>
                                   <th>Login</th>
                                   <th>Nom</th>
                                   <th>Prénom</th>
                                   <th>Role</th>
                                   <th>Actions</th>
                              </tr>
                         </thead>
                         <tfoot class="hidden-xs">
                              <tr>
                                   <th>Login</th>
                                   <th>Nom</th>
                                   <th>Prénom</th>
                                   <th>Role</th>
                                   <th>Actions</th>
                              </tr>
                         </tfoot>
                         <tbody>
                              <tr th:each="user : ${users}">
                                   <td class="" th:text="${user.login}">Login</td>
                                   <td class="" th:text="${user.lastname}">Nom</td>
                                   <td class="" th:text="${user.firstname}">Prénom</td>
                                   <td class="" th:text="${user.roleName}">Role</td>
                                   <td>
                         <nobr>
                              <a class="custom-link" th:href="'users/form/' + ${user.id}">
                                   <button class='btn btn-primary btn-xs dt-edit' title="Modifier l'utilisateur">
                                        <span class='fa fa-pencil' aria-hidden="true"></span>
                                   </button>
                              </a>
                              <button class='btn btn-danger btn-xs dt-delete' title="Supprimer l'utilisateur" data-th-attr="data-user-id=${user.id}">
                                   <span class="fa fa-trash" aria-hidden="true"></span>
                              </button>

                         </nobr>
                         </td>
                         </tr>
                         </tbody>
                    </table>
               </div>
          </div>
     </div>
</div>


<script type="text/javascript" th:inline="javascript" charset="UTF-8">
     /*<![CDATA[*/


     $(function () {


          var userDataTable = null;

          // DataTable initialisation
          userDataTable = $('#users-table').DataTable({
               responsive: true,
               dom: '<"toolbar">Bfrtip',
               initComplete: function () {
                    $("div.dt-buttons").addClass("col-xs-12 no-padding").append('<div class="pull-right">' +
                            '<a class="custom-link" th:href="users/form" href="users/form"> ' +
                            ' <button type="button" style="float: right; margin-bottom: 5px;" class="btn btn-success dt-new new-user">Nouvel utlisateur</button></a></div>');
               }
          });


          //Delete buttons

          userDataTable.on('click', '.dt-delete', function (event) {

               var row = $(this).closest("tr");
               var userId = $(this).data('user-id');
               $.confirm({
                    title: "Supppression d'un utilisateur",
                    content: "Voulez-vous vraiment supprimer cet utilisateur ?",
                    type: "red",
                    buttons: {
                         modify: {
                              text: "Supprimer",
                              btnClass: "btn-red",
                              action: function () {
                                   $.ajax({
                                        url: "users/" + userId,
                                        type: 'DELETE',
                                        success: function () {
                                             userDataTable.row(row).remove().draw();
                                        }
                                   });
                              },
                              cancel: {
                                   text: "Annuler"
                              }
                         }
                    }
               });
               event.preventDefault();
          });

     });

     /*]]>*/
</script>
